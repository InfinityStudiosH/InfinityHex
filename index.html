<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Generador de Colores HEX Galaxia | Infinity Studio</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron&family=Roboto&display=swap" rel="stylesheet" />
  <style>
    /* Estilos b√°sicos y galaxia */
    body {
      margin: 0; padding: 0; font-family: 'Roboto', sans-serif;
      background: radial-gradient(circle at center, #1b2735 0%, #090a0f 100%);
      color: #eee;
      min-height: 100vh;
      display: flex; flex-direction: column; align-items: center; padding: 20px;
      transition: background-color 0.5s, color 0.5s;
      user-select: none;
    }
    h1 {
      font-family: 'Orbitron', sans-serif;
      color: #9a14ff;
      text-align: center;
      margin-bottom: 0.5rem;
      text-shadow: 0 0 10px #9a14ff;
    }
    .container {
      max-width: 1000px;
      width: 100%;
      background: rgba(20, 10, 40, 0.9);
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 30px #9a14ff99;
    }
    .flex-row {
      display: flex; flex-wrap: wrap; gap: 1rem; justify-content: center;
    }
    label {
      display: block;
      margin-bottom: 0.25rem;
      font-weight: 700;
    }
    input[type=color], input[type=number], input[type=text] {
      border-radius: 8px;
      border: none;
      padding: 0.3rem;
      font-size: 1rem;
      cursor: pointer;
      outline-offset: 2px;
      transition: box-shadow 0.3s ease;
    }
    input[type=color]:focus, input[type=number]:focus, input[type=text]:focus {
      box-shadow: 0 0 8px #9a14ff;
    }
    button {
      background: #9a14ff;
      border: none;
      border-radius: 8px;
      padding: 0.5rem 1rem;
      color: white;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s ease;
      text-shadow: 0 0 5px #6b0bbd;
      user-select: none;
    }
    button:hover {
      background: #7a0ecb;
      text-shadow: 0 0 10px #7a0ecb;
    }
    .color-box {
      width: 50px; height: 50px;
      border-radius: 10px;
      cursor: pointer;
      box-shadow: 0 0 10px #4d0080;
      transition: transform 0.3s ease;
      position: relative;
    }
    .color-box:hover {
      transform: scale(1.1);
    }
    .color-label {
      font-family: monospace;
      font-size: 0.85rem;
      margin-top: 0.25rem;
      text-align: center;
      user-select: text;
    }
    .palette {
      margin-top: 1rem;
      padding: 1rem;
      border-radius: 12px;
      background: #140026aa;
      box-shadow: inset 0 0 10px #9a14ffcc;
    }
    .palette-title {
      font-weight: 700;
      font-size: 1.2rem;
      margin-bottom: 0.5rem;
      color: #d6aaff;
      text-shadow: 0 0 6px #d6aaffaa;
      user-select: none;
    }
    .palette-colors {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
      justify-content: center;
    }
    .gradient-preview {
      width: 100%;
      height: 60px;
      border-radius: 12px;
      margin-top: 1rem;
      box-shadow: 0 0 20px #9a14ffbb;
      cursor: pointer;
      user-select: none;
      transition: box-shadow 0.3s ease;
    }
    .gradient-preview:hover {
      box-shadow: 0 0 30px #cc7fffdd;
    }
    .controls {
      margin-top: 1rem;
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      justify-content: center;
    }
    .info-box {
      margin-top: 1rem;
      background: #3e0066cc;
      border-radius: 12px;
      padding: 1rem;
      font-family: monospace;
      font-size: 0.9rem;
      line-height: 1.3;
      user-select: text;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 60px;
      height: 34px;
      user-select: none;
    }
    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0; left: 0; right: 0; bottom: 0;
      background-color: #ccc;
      transition: 0.4s;
      border-radius: 34px;
    }
    .slider:before {
      position: absolute;
      content: "";
      height: 26px;
      width: 26px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: 0.4s;
      border-radius: 50%;
    }
    input:checked + .slider {
      background-color: #9a14ff;
      box-shadow: 0 0 10px #9a14ffcc;
    }
    input:checked + .slider:before {
      transform: translateX(26px);
    }
    @media (max-width: 600px) {
      .flex-row {
        flex-direction: column;
        align-items: center;
      }
      .color-box {
        width: 40px; height: 40px;
      }
      .gradient-preview {
        height: 40px;
      }
    }
  </style>
</head>
<body>
  <h1>Generador de Colores HEX Galaxia</h1>
  <div class="container">
    <div class="flex-row" style="align-items:center; gap: 1rem;">
      <div>
        <label for="colorPicker">Selecciona color (HEX):</label>
        <input type="color" id="colorPicker" value="#9a14ff" />
      </div>
      <div>
        <label for="colorInput">O escribe HEX (#rrggbb):</label>
        <input type="text" id="colorInput" value="#9a14ff" maxlength="7" pattern="#[0-9a-fA-F]{6}" />
      </div>
      <div>
        <label for="rgbInput">RGB (r,g,b):</label>
        <input type="text" id="rgbInput" placeholder="e.g. 154,20,255" />
      </div>
      <div>
        <button id="addColorBtn" title="Agregar color a la paleta">‚ûï Agregar Color</button>
      </div>
    </div>

    <div class="palette" id="paletteContainer">
      <div class="palette-title">Paleta Actual</div>
      <div class="palette-colors" id="paletteColors"></div>
      <button id="clearPaletteBtn" style="margin-top: 1rem;">üóëÔ∏è Limpiar Paleta</button>
    </div>

    <div class="controls">
      <label for="gradientDirection">Direcci√≥n Gradiente:</label>
      <select id="gradientDirection">
        <option value="to right">Horizontal</option>
        <option value="to bottom">Vertical</option>
        <option value="to top right">Diagonal ‚ÜóÔ∏è</option>
        <option value="to bottom left">Diagonal ‚ÜôÔ∏è</option>
      </select>

      <label for="stepsGradient">Pasos del Gradiente (2-30):</label>
      <input type="number" id="stepsGradient" value="5" min="2" max="30" style="width: 60px;" />

      <button id="generateGradientBtn">üé® Generar Gradiente</button>
      <button id="downloadJsonBtn">üíæ Descargar JSON</button>
      <button id="downloadPngBtn">üì∑ Descargar Imagen</button>
      <button id="randomPaletteBtn" title="Generar paleta aleatoria">üé≤ Aleatorio</button>
    </div>

    <div id="gradientOutput" class="flex-row" style="margin-top: 1rem; justify-content:center;"></div>

    <div class="info-box" id="infoBox" style="display:none;"></div>

    <div id="palettes" style="margin-top:2rem;">
      <div class="palette-title">Paletas Predefinidas</div>
    </div>

    <div style="margin-top:2rem; text-align:center;">
      <label class="toggle-switch" title="Modo oscuro / claro">
        <input type="checkbox" id="modeToggle" />
        <span class="slider"></span>
      </label>
      <span>Modo Oscuro / Claro</span>
    </div>

  </div>

  <script>
    // Utilidades para color y conversi√≥n
    function hexToRgb(hex) {
      const m = hex.match(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i);
      if(!m) return null;
      return {
        r: parseInt(m[1], 16),
        g: parseInt(m[2], 16),
        b: parseInt(m[3], 16),
      };
    }
    function rgbToHex(r,g,b) {
      return "#" + [r,g,b].map(x => x.toString(16).padStart(2,"0")).join("");
    }
    function rgbToHsl(r,g,b) {
      r /= 255; g /= 255; b /= 255;
      const max = Math.max(r,g,b), min = Math.min(r,g,b);
      let h,s,l = (max+min)/2;
      if(max === min){
        h=s=0;
      } else {
        const d = max - min;
        s = l > 0.5 ? d/(2 - max - min) : d/(max+min);
        switch(max){
          case r: h = (g-b)/d + (g < b ? 6 : 0); break;
          case g: h = (b-r)/d + 2; break;
          case b: h = (r-g)/d + 4; break;
        }
        h /= 6;
      }
      return {h:h*360, s:s*100, l:l*100};
    }
    function hslToRgb(h,s,l){
      h /= 360; s /= 100; l /= 100;
      let r,g,b;
      if(s === 0){
        r=g=b=l;
      } else {
        const hue2rgb = (p,q,t) => {
          if(t<0) t+=1;
          if(t>1) t-=1;
          if(t<1/6) return p + (q-p)*6*t;
          if(t<1/2) return q;
          if(t<2/3) return p + (q-p)*(2/3 - t)*6;
          return p;
        }
        const q = l < 0.5 ? l*(1+s) : l+s - l*s;
        const p = 2*l - q;
        r = hue2rgb(p,q,h + 1/3);
        g = hue2rgb(p,q,h);
        b = hue2rgb(p,q,h - 1/3);
      }
      return {r:Math.round(r*255), g:Math.round(g*255), b:Math.round(b*255)};
    }

    // Interpolar entre dos colores rgb en t (0-1)
    function lerpColor(c0, c1, t){
      return {
        r: Math.round(c0.r + (c1.r - c0.r)*t),
        g: Math.round(c0.g + (c1.g - c0.g)*t),
        b: Math.round(c0.b + (c1.b - c0.b)*t)
      };
    }

    // Generar gradiente con varios colores
    function generateGradient(colors, steps) {
      if(colors.length < 2) return [];
      const segments = colors.length - 1;
      const colorsRgb = colors.map(c => hexToRgb(c));
      const gradientColors = [];
      const stepsPerSegment = Math.floor(steps / segments);
      for(let i = 0; i < segments; i++){
        for(let j = 0; j < stepsPerSegment; j++){
          const t = j / stepsPerSegment;
          gradientColors.push(lerpColor(colorsRgb[i], colorsRgb[i+1], t));
        }
      }
      // Ajustar al total de steps
      while(gradientColors.length < steps){
        gradientColors.push(colorsRgb[colorsRgb.length - 1]);
      }
      return gradientColors;
    }

    // Contraste WCAG (luminosidad relativa)
    function getLuminance(c){
      const a = [c.r, c.g, c.b].map(v => {
        v /= 255;
        return v <= 0.03928 ? v/12.92 : Math.pow((v+0.055)/1.055, 2.4);
      });
      return 0.2126*a[0] + 0.7152*a[1] + 0.0722*a[2];
    }
    function contrastRatio(c1, c2){
      const L1 = getLuminance(c1);
      const L2 = getLuminance(c2);
      return (Math.max(L1,L2)+0.05) / (Math.min(L1,L2)+0.05);
    }

    // Complementario
    function complementaryColor(hex) {
      const rgb = hexToRgb(hex);
      if(!rgb) return null;
      const hsl = rgbToHsl(rgb.r, rgb.g, rgb.b);
      hsl.h = (hsl.h + 180) % 360;
      const comp = hslToRgb(hsl.h, hsl.s, hsl.l);
      return rgbToHex(comp.r, comp.g, comp.b);
    }
    // An√°logos: h-30, h+30
    function analogousColors(hex){
      const rgb = hexToRgb(hex);
      if(!rgb) return [];
      const hsl = rgbToHsl(rgb.r, rgb.g, rgb.b);
      return [
        rgbToHex(...Object.values(hslToRgb((hsl.h+330)%360, hsl.s, hsl.l))),
        rgbToHex(...Object.values(hslToRgb((hsl.h+30)%360, hsl.s, hsl.l))),
      ];
    }
    // Triada: h, h+120, h+240
    function triadicColors(hex){
      const rgb = hexToRgb(hex);
      if(!rgb) return [];
      const hsl = rgbToHsl(rgb.r, rgb.g, rgb.b);
      return [
        rgbToHex(...Object.values(hslToRgb(hsl.h, hsl.s, hsl.l))),
        rgbToHex(...Object.values(hslToRgb((hsl.h+120)%360, hsl.s, hsl.l))),
        rgbToHex(...Object.values(hslToRgb((hsl.h+240)%360, hsl.s, hsl.l))),
      ];
    }

    // Estado y referencias DOM
    const colorPicker = document.getElementById('colorPicker');
    const colorInput = document.getElementById('colorInput');
    const rgbInput = document.getElementById('rgbInput');
    const addColorBtn = document.getElementById('addColorBtn');
    const paletteColorsDiv = document.getElementById('paletteColors');
    const clearPaletteBtn = document.getElementById('clearPaletteBtn');
    const gradientDirection = document.getElementById('gradientDirection');
    const stepsGradient = document.getElementById('stepsGradient');
    const generateGradientBtn = document.getElementById('generateGradientBtn');
    const gradientOutput = document.getElementById('gradientOutput');
    const infoBox = document.getElementById('infoBox');
    const downloadJsonBtn = document.getElementById('downloadJsonBtn');
    const downloadPngBtn = document.getElementById('downloadPngBtn');
    const randomPaletteBtn = document.getElementById('randomPaletteBtn');
    const modeToggle = document.getElementById('modeToggle');

    let palette = JSON.parse(localStorage.getItem('galaxiaPalette')) || ['#9a14ff'];

    // Actualizar inputs de color sincronizados
    function updateColorInputs(hex) {
      if(/^#([0-9a-f]{6})$/i.test(hex)){
        colorInput.value = hex.toLowerCase();
        colorPicker.value = hex.toLowerCase();
        const rgb = hexToRgb(hex);
        rgbInput.value = `${rgb.r},${rgb.g},${rgb.b}`;
      }
    }
    colorPicker.addEventListener('input', e => {
      updateColorInputs(e.target.value);
    });
    colorInput.addEventListener('input', e => {
      const val = e.target.value.toLowerCase();
      if(/^#([0-9a-f]{6})$/.test(val)){
        updateColorInputs(val);
      }
    });
    rgbInput.addEventListener('input', e => {
      const val = e.target.value;
      const parts = val.split(',').map(x => parseInt(x.trim()));
      if(parts.length === 3 && parts.every(n => n >= 0 && n <= 255 && !isNaN(n))){
        const hex = rgbToHex(parts[0], parts[1], parts[2]);
        updateColorInputs(hex);
      }
    });

    // Render paleta
    function renderPalette(){
      paletteColorsDiv.innerHTML = '';
      palette.forEach((hex, i) => {
        const box = document.createElement('div');
        box.className = 'color-box';
        box.style.backgroundColor = hex;
        box.title = hex + '\nClick para copiar\nDoble click para eliminar';
        box.tabIndex = 0;

        // Tooltip para info de contraste
        box.addEventListener('mouseenter', () => {
          const bg = {r: 27, g: 39, b: 53};
          const fg = hexToRgb(hex);
          const cRatio = contrastRatio(bg, fg).toFixed(2);
          infoBox.style.display = 'block';
          infoBox.textContent = `Color: ${hex.toUpperCase()} - Contraste con fondo: ${cRatio} (WCAG)`;
        });
        box.addEventListener('mouseleave', () => {
          infoBox.style.display = 'none';
          infoBox.textContent = '';
        });

        box.addEventListener('click', () => {
          navigator.clipboard.writeText(hex);
          alert(`Color ${hex} copiado al portapapeles`);
        });
        box.addEventListener('dblclick', () => {
          if(palette.length > 1){
            palette.splice(i,1);
            savePalette();
            renderPalette();
          } else {
            alert("No puedes eliminar el √∫ltimo color.");
          }
        });
        paletteColorsDiv.appendChild(box);
      });
    }
    function savePalette(){
      localStorage.setItem('galaxiaPalette', JSON.stringify(palette));
    }

    // A√±adir color
    addColorBtn.addEventListener('click', () => {
      const hex = colorInput.value.toLowerCase();
      if(/^#([0-9a-f]{6})$/.test(hex)){
        if(!palette.includes(hex)){
          palette.push(hex);
          savePalette();
          renderPalette();
        } else {
          alert("El color ya est√° en la paleta.");
        }
      } else {
        alert("Ingrese un color HEX v√°lido (ejemplo: #aabbcc).");
      }
    });
    clearPaletteBtn.addEventListener('click', () => {
      if(confirm("¬øDesea limpiar toda la paleta?")){
        palette = [];
        savePalette();
        renderPalette();
        gradientOutput.innerHTML = '';
      }
    });

    // Generar gradiente y mostrar
    generateGradientBtn.addEventListener('click', () => {
      if(palette.length < 2){
        alert("Agrega al menos 2 colores para generar un gradiente.");
        return;
      }
      let steps = parseInt(stepsGradient.value);
      if(isNaN(steps) || steps < 2) steps = 5;
      if(steps > 30) steps = 30;
      const gradientColors = generateGradient(palette, steps);
      gradientOutput.innerHTML = '';
      gradientColors.forEach(c => {
        const div = document.createElement('div');
        div.style.width = (100/steps) + '%';
        div.style.height = '60px';
        div.style.backgroundColor = rgbToHex(c.r,c.g,c.b);
        gradientOutput.appendChild(div);
      });
      gradientOutput.style.flexDirection = 'row';

      // Mostrar CSS gradiente para copiar
      const direction = gradientDirection.value;
      const cssGradient = `linear-gradient(${direction}, ${palette.join(', ')})`;
      infoBox.style.display = 'block';
      infoBox.innerHTML = `<b>CSS gradiente:</b><br><code>background: ${cssGradient};</code>`;
    });

    // Descargar JSON
    downloadJsonBtn.addEventListener('click', () => {
      if(palette.length < 1){
        alert("La paleta est√° vac√≠a.");
        return;
      }
      const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(palette, null, 2));
      const dlAnchor = document.createElement('a');
      dlAnchor.setAttribute("href", dataStr);
      dlAnchor.setAttribute("download", "paleta_galaxia.json");
      document.body.appendChild(dlAnchor);
      dlAnchor.click();
      dlAnchor.remove();
    });

    // Descargar PNG (imagen con paleta)
    downloadPngBtn.addEventListener('click', () => {
      if(palette.length < 1){
        alert("La paleta est√° vac√≠a.");
        return;
      }
      const canvas = document.createElement('canvas');
      canvas.width = 500;
      canvas.height = 100;
      const ctx = canvas.getContext('2d');
      const w = canvas.width / palette.length;
      palette.forEach((color, i) => {
        ctx.fillStyle = color;
        ctx.fillRect(i * w, 0, w, canvas.height);
      });
      canvas.toBlob(blob => {
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = "paleta_galaxia.png";
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
      });
    });

    // Generar paleta aleatoria
    randomPaletteBtn.addEventListener('click', () => {
      palette = [];
      for(let i = 0; i < 5; i++){
        const r = Math.floor(Math.random()*256);
        const g = Math.floor(Math.random()*256);
        const b = Math.floor(Math.random()*256);
        palette.push(rgbToHex(r,g,b));
      }
      savePalette();
      renderPalette();
      gradientOutput.innerHTML = '';
      infoBox.style.display = 'none';
    });

    // Modo oscuro / claro
    modeToggle.addEventListener('click', () => {
      document.body.classList.toggle('dark-mode');
      if(document.body.classList.contains('dark-mode')){
        modeToggle.textContent = "Modo Claro";
      } else {
        modeToggle.textContent = "Modo Oscuro";
      }
    });

    // Inicializar
    updateColorInputs(palette[0]);
    renderPalette();
  </script>
</body>
</html>

